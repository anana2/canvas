<!doctype html>
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<style>
html{
	height:100%;
}
body{
	height:90%;
}
div#mid{
	image-rendering: pixelated;
	background-color: gray;
	width: 100%;
	height: 100%;
	overflow:hidden;
}
div#midpos{
	transform: translate(0px,0px);
	height: 100%;
}
div#midscale{
	transform: scale(1,1);
	height: 100%;
}
#canvas{
	background-color: #eeeeee;
	padding: 0;
    margin: auto;
    display: block;
	height: 100%;
}
</style>
<script>
var map = [];
for(var i = 0; i < 1000; i++){
	map[i] = [];
	for(var j = 0; j < 1000; j++){
		map[i][j] = false;
	}
}
var x = 0;
var y = 0;
var z = 1;
var mousex = 0;
var mousey = 0;
var clickx = 0;
var clicky = 0;
var diffx = 0;
var diffy = 0;
var drawing = true;
var moving = false;
var interval;
$(function(){
	var cv = document.getElementById("canvas");
	var pos = document.getElementById("midpos");
	var cv2 = cv.getContext("2d");
	addEventListener("mousemove",function(event){
		writeMessage(cv);
	});
	cv.addEventListener("mousedown",function(event){
		if(drawing){
			drawCanvas(cv);
			interval = setInterval(function(){
				drawCanvas(cv);
			}, 10);
		}
	});
	addEventListener("mousedown",function(event){
		if(!drawing){
			clickx = mousex;
			clicky = mousey;
			moving = true;
			interval = setInterval(function(){}, 1000);
		}
	});
	
	addEventListener("mouseup",function(){
		clearInterval(interval);
		moving = false;
	});
});//end $(function(){});

function ChangeDrawing(){
	if(drawing){
		drawing = false;
		
		var n = document.getElementById("testbutton");
		var message = "Moving"; 
		n.textContent = message;
	}
	else{
		drawing = true;
		
		var n = document.getElementById("testbutton");
		var message = "Drawing"; 
		n.textContent = message;
	}
	console.log("done");
};

function ZoomIn(){
	moving = false;
	var div = document.getElementById("midscale");
	z = z*2;
	if(z > 32){
		z = 32;
	}
	div.style.transform = "scale("+z+","+z+")";
	
	var n = document.getElementById("zoomlevel");
	var message = "Zoom: "+z+"x  "; 
	n.innerHTML = message;
};
function ZoomOut(){
	moving = false;
	var div = document.getElementById("midscale");
	z = z/2;
	if(z < 1){
		z = 1;
	}
	div.style.transform = "scale("+z+","+z+")";
	
	var n = document.getElementById("zoomlevel");
	var message = "Zoom: "+z+"x  "; 
	n.innerHTML = message;
};
function writeMessage(canvas){
	var ctx = canvas.getContext("2d");
	var rect = canvas.getBoundingClientRect();
	var width = rect.right - rect.left;
	var height = rect.bottom - rect.top;
	var mult = width/1000;
	var mult2 = height/1000;
	
	if(mousex > -1 && mousex < 1000 && mousey > -1 && mousey < 1000){
		if(!map[mousex][mousey]){
			ctx.clearRect(mousex,mousey,1,1);
		}
	}
	
	mousex = event.clientX - rect.left;
	mousey = event.clientY - rect.top;
	mousex = Math.floor(mousex/mult);
	mousey = Math.floor(mousey/mult2);
	if(moving){
		diffx = mousex-clickx;
		diffy = mousey-clicky;
		
		var div = document.getElementById("midpos");
		x = x+(mult*diffx/z);
		y = y+(mult2*diffy/z);
		if((-500*mult)<x){
			if(x<(500*mult)){
				if((-500*mult2)<y){
					if(y<(500*mult2)){
						div.style.transform = "translate(" + x + "px," + y +"px)";
					}
					else{
						y = 500*mult2;
						div.style.transform = "translate(" + x + "px," + y +"px)";
					}
				}
				else{
					y = -500*mult2;
					div.style.transform = "translate(" + x + "px," + y +"px)";
				}
			}
			else{
				x = 500*mult;
				div.style.transform = "translate(" + x + "px," + y +"px)";
			}
		}
		else{
			x = -500*mult;
			div.style.transform = "translate(" + x + "px," + y +"px)";
		}
		mousex = mousex-diffx;
		mousey = mousey-diffy;
		
		var n = document.getElementById("translatelevel");
		var message = "Camera Position: "+Math.floor(x)+" "+Math.floor(y)+"  ";  
		n.innerHTML = message;
	}
	
	if(mousex > -1 && mousex < 1000 && mousey > -1 && mousey < 1000){
		if(!map[mousex][mousey]){
			ctx.fillRect(mousex,mousey,1,1);
		}
	}
	
	var n = document.getElementById("position");
	var message = "Mouse Position: "+mousex+" "+mousey+" "; 
	n.innerHTML = message;
};
function drawCanvas(canvas){
	if(!map[mousex][mousey]){
		map[mousex][mousey] = true;
		var ctx = canvas.getContext("2d");
		ctx.fillRect(mousex,mousey,1,1);
	}
};
</script>
</head>
<body>
<div class="top" height="10%">
<button id="zoom" onclick="ZoomIn()">zoom+</button>
<button id="zoom2" onclick="ZoomOut()">zoom-</button>
<button id="testbutton" onclick="ChangeDrawing()">Drawing</button>
<span id="zoomlevel">Zoom: 1x  </span>
<span id="translatelevel">Camera Position: 0 0  </span>
<span id="position">Mouse Position: 0 0  </span>
</div>
<div id="mid">
<div id="midscale">
<div id="midpos">
<canvas id="canvas" width="1000" height="1000">
Your browser does not support the HTML5 canvas tag.
</canvas>
</div>
</div>
</div>
<div class="bottom" height="10%">
</div>
</body>
</html>